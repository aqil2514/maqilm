---
import type { CollectionEntry } from "astro:content";
import BaseHead from "../BaseHead.astro";
import Header from "../organisms/Header.astro";
import ContainerArticle from "../organisms/ContainerArticle.astro";
import ImageHero from "../atoms/ImageHero.astro";
import ArticleBlogMeta from "../molecules/ArticleBlogMeta.astro";
import Footer from "../organisms/Footer.astro";

import { convertGoogleDriveUrl } from "../../utils";
import WidgetNavigation from "../molecules/WidgetNavigation.astro";
import WidgetPersonalization from "../molecules/WidgetPersonalization.astro";
import Sidebar from "../organisms/Sidebar.astro";

type Props = CollectionEntry<"blog">["data"];

const {
  title,
  description,
  pubDate,
  updatedDate,
  heroImage = "/notfound-image.png",
  author = "Anonymous",
  tags,
  category,
  captHeroImage,
} = Astro.props;

const test = convertGoogleDriveUrl(
  "https://drive.google.com/file/d/1XsYT-nlcoxkhSGONZbxpcwXYawoBKMnP/view?usp=drive_link"
);

console.log(test);
---

<html lang="en">
  <head>
    <BaseHead
      title={title}
      description={description}
      image={heroImage}
      author={author || "Anonymous"}
      tags={tags}
    />
    <style>
      main {
        max-width: 100%;
        margin: 0;
        display: grid;
        grid-template-columns: 5% auto;
      }

      .sidebar {
        display: flex;
        flex-direction: column;
        margin-top: 4rem;
        gap: 1rem;
      }

      .sidebar div {
        background-color: white;
        border-radius: 1rem;
        padding: 2rem;
      }

      .prose-sidebar-wrapper {
        display: grid;
        grid-template-columns: 70% auto;
        gap: 1rem;
      }

      @media (max-width: 720px) {
        main {
          width: 100%;
          display: block;
          padding: 0;
        }

        .prose-sidebar-wrapper {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .sidebar {
          margin-top: 0;
        }
      }
    </style>
  </head>

  <body>
    <Header />
    <main>
      <div></div>
      <div class="prose-sidebar-wrapper">
        <ContainerArticle>
          <h1 class="title">{title}</h1>

          <ImageHero
            heroImage={heroImage}
            pubDate={pubDate}
            title={title}
            updatedDate={updatedDate}
            captHeroImage={captHeroImage}
          />

          <ArticleBlogMeta author={author} category={category} tags={tags} />

          <slot />
        </ContainerArticle>
        <div class="sidebar">
          <Sidebar />
        </div>
      </div>
    </main>
    <Footer />
  </body>
</html>
