---
import { Image } from "astro:assets";
import type { RenderedContent } from "astro:content";
import type { InferEntrySchema } from "astro:content";

interface Props {
  posts: {
    id: string;
    body?: string;
    collection: "blog";
    data: InferEntrySchema<"blog">;
    rendered?: RenderedContent;
    filePath?: string;
  }[];
}

const { posts } = Astro.props;
const totalSlots = 5;

const categoryName = posts[0].data.category;
const articles = posts.slice(0, totalSlots);

const placeholders = Array.from(
  { length: totalSlots - articles.length },
  () => ({
    id: "#",
    data: {
      title: "Coming Soon...",
      heroImage: "/notfound-image.png",
    },
  })
);
---

<section>
  <h2>{categoryName}</h2>
  <div class="image-container">
    {
      [...articles, ...placeholders].map((art) => {
        const url = art.id === "#" ? "#" : `/blog/${art.id}`;
        return (
          <a href={url}>
            <figure>
              <Image
                src={
                  art.data.heroImage
                    ? art.data.heroImage
                    : "/notfound-image.png"
                }
                height={320}
                width={320}
                alt={art.data.title + " Image"}
              />
              <figcaption>{art.data.title}</figcaption>
            </figure>
          </a>
        );
      })
    }
  </div>
</section>

<style>
  h2 {
    color: var(--primary-text);
    font-family: "Atkinson", Courier, monospace;
  }

  .image-container {
    display: flex;
    gap: 1rem;
    max-width: 990px;
    overflow-x: auto;
    white-space: nowrap;
  }

  .image-container figure {
    display: inline-block;
    border-radius: 1rem;
    position: relative;
    z-index: 1;
  }

  .image-container figure img {
    border-radius: 1rem;
    opacity: 0.8;
    transition: 200ms;
  }

  .image-container figure:hover img {
    opacity: 1;
  }

  .image-container figure figcaption {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
    position: absolute;
    z-index: 2;
    bottom: 7%;
    left: 5%;
    padding: 0 0.5rem;
    border-radius: 0.5rem;
    color: whitesmoke;
    background-color: #000000d7;
    max-width: 280px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: normal;
  }

  .image-container::-webkit-scrollbar {
    height: 10px;
    width: 10px;
  }

  .image-container::-webkit-scrollbar-track {
    border-radius: 5px;
    background-color: var(--body-background);
  }

  .image-container::-webkit-scrollbar-track:hover {
    background-color: #b8c0c2;
  }

  .image-container::-webkit-scrollbar-track:active {
    background-color: #b8c0c2;
  }

  .image-container::-webkit-scrollbar-thumb {
    border-radius: 5px;
    background-color: var(--primary-text);
  }

  .image-container::-webkit-scrollbar-thumb:hover {
    background-color: #62a34b;
  }

  .image-container::-webkit-scrollbar-thumb:active {
    background-color: #62a34b;
  }
</style>
