---
import CategoryList from "../atoms/CategoryList.astro";
import Sidebar from "../organisms/Sidebar.astro";
import { getCollection } from "astro:content";
import { getContentCategories } from "../../utils/index";

const posts = await getCollection("blog");
const categories = getContentCategories(posts).slice(0, 5);
---

<div class="inner-container">
  <div class="category-list">
    {
      categories.map((cat) => {
        const collection = posts.filter((post) => post.data.category === cat);

        if (!collection) return null;

        return <CategoryList posts={collection} />; //Kenapa hanya worklife saja yang diterima? 5-5nya worklife
      })
    }
    <section>
      <!-- TODO : Event Handling di Astro agak tricky, kerjain nanti ajah -->
      <button id="more-category">More category</button>
    </section>
  </div>
  <Sidebar />
</div>


<script>
  const moreCategoryButton = document.getElementById(
    "more-category"
  ) as HTMLButtonElement;

  const buttonHandler = () => {
    alert("Under Development");
  };

  moreCategoryButton.addEventListener("click", buttonHandler);
</script>

<style>
  .inner-container {
    display: grid;
    grid-template-columns: auto 30%;
    gap: 1rem;
  }

  .category-list {
    border-radius: 1rem;
    background-color: var(--primary-background);
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .container {
    padding: 1rem;
    min-height: 100vh;
  }
</style>
